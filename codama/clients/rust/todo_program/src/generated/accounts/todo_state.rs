//! This code was AUTOGENERATED by `pina_codama_renderer`.
//! Please DO NOT EDIT THIS FILE directly.
//! Regenerate it from Codama IDLs instead.

use bytemuck::Pod;
use bytemuck::Zeroable;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Pod, Zeroable)]
pub struct TodoState {
	pub discriminator: u8,
	pub owner: solana_pubkey::Pubkey,
	pub bump: u8,
	pub completed: pina_pod_primitives::PodBool,
	pub digest: [u8; 32],
}

pub const TODO_STATE_DISCRIMINATOR: u8 = 1u8;

impl TodoState {
	pub const LEN: usize = core::mem::size_of::<Self>();

	pub const fn new(owner: solana_pubkey::Pubkey, bump: u8, completed: pina_pod_primitives::PodBool, digest: [u8; 32]) -> Self {
		Self {
			discriminator: TODO_STATE_DISCRIMINATOR,
			owner,
			bump,
			completed,
			digest,
		}
	}

	pub fn from_bytes(data: &[u8]) -> Result<&Self, solana_program_error::ProgramError> {
		let account = bytemuck::try_from_bytes::<Self>(data)
			.map_err(|_| solana_program_error::ProgramError::InvalidAccountData)?;
		if account.discriminator != TODO_STATE_DISCRIMINATOR {
			return Err(solana_program_error::ProgramError::InvalidAccountData);
		}
		Ok(account)
	}

	pub fn from_bytes_mut(data: &mut [u8]) -> Result<&mut Self, solana_program_error::ProgramError> {
		let account = bytemuck::try_from_bytes_mut::<Self>(data)
			.map_err(|_| solana_program_error::ProgramError::InvalidAccountData)?;
		if account.discriminator != TODO_STATE_DISCRIMINATOR {
			return Err(solana_program_error::ProgramError::InvalidAccountData);
		}
		Ok(account)
	}
}

impl<'a> TryFrom<&solana_account_info::AccountInfo<'a>> for TodoState {
	type Error = solana_program_error::ProgramError;

	fn try_from(account_info: &solana_account_info::AccountInfo<'a>) -> Result<Self, Self::Error> {
		let data_ref = (*account_info.data).borrow();
		let account = Self::from_bytes(&data_ref)?;
		Ok(*account)
	}
}

//! This code was AUTOGENERATED by `pina_codama_renderer`.
//! Please DO NOT EDIT THIS FILE directly.
//! Regenerate it from Codama IDLs instead.

use bytemuck::Pod;
use bytemuck::Zeroable;

#[repr(C)]
#[derive(Clone, Copy, Debug, PartialEq, Eq, Pod, Zeroable)]
pub struct EscrowState {
	pub discriminator: u8,
	pub maker: solana_pubkey::Pubkey,
	pub mint_a: solana_pubkey::Pubkey,
	pub mint_b: solana_pubkey::Pubkey,
	/// The amount of token A that was sent by sender.
	pub amount_a: pina_pod_primitives::PodU64,
	/// The amount of token B to be received by the recipient.
	pub amount_b: pina_pod_primitives::PodU64,
	pub seed: pina_pod_primitives::PodU64,
	pub bump: u8,
}

pub const ESCROW_STATE_DISCRIMINATOR: u8 = 1u8;

impl EscrowState {
	pub const LEN: usize = core::mem::size_of::<Self>();

	pub const fn new(maker: solana_pubkey::Pubkey, mint_a: solana_pubkey::Pubkey, mint_b: solana_pubkey::Pubkey, amount_a: pina_pod_primitives::PodU64, amount_b: pina_pod_primitives::PodU64, seed: pina_pod_primitives::PodU64, bump: u8) -> Self {
		Self {
			discriminator: ESCROW_STATE_DISCRIMINATOR,
			maker,
			mint_a,
			mint_b,
			amount_a,
			amount_b,
			seed,
			bump,
		}
	}

	pub fn from_bytes(data: &[u8]) -> Result<&Self, solana_program_error::ProgramError> {
		let account = bytemuck::try_from_bytes::<Self>(data)
			.map_err(|_| solana_program_error::ProgramError::InvalidAccountData)?;
		if account.discriminator != ESCROW_STATE_DISCRIMINATOR {
			return Err(solana_program_error::ProgramError::InvalidAccountData);
		}
		Ok(account)
	}

	pub fn from_bytes_mut(data: &mut [u8]) -> Result<&mut Self, solana_program_error::ProgramError> {
		let account = bytemuck::try_from_bytes_mut::<Self>(data)
			.map_err(|_| solana_program_error::ProgramError::InvalidAccountData)?;
		if account.discriminator != ESCROW_STATE_DISCRIMINATOR {
			return Err(solana_program_error::ProgramError::InvalidAccountData);
		}
		Ok(account)
	}
}

impl<'a> TryFrom<&solana_account_info::AccountInfo<'a>> for EscrowState {
	type Error = solana_program_error::ProgramError;

	fn try_from(account_info: &solana_account_info::AccountInfo<'a>) -> Result<Self, Self::Error> {
		let data_ref = (*account_info.data).borrow();
		let account = Self::from_bytes(&data_ref)?;
		Ok(*account)
	}
}
